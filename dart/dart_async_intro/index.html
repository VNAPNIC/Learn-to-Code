



<!doctype html>
<html lang="vi" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Tổng hợp tài liệu học lập trình">
      
      
        <link rel="canonical" href="https://buihainam.com/dart/dart_async_intro/">
      
      
        <meta name="author" content="Bùi Hải Nam">
      
      
        <meta name="lang:clipboard.copy" content="Sao chép vào bộ nhớ">
      
        <meta name="lang:clipboard.copied" content="Sao chép xong">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="Không tìm thấy tài liệu liên quan">
      
        <meta name="lang:search.result.one" content="1 tài liệu liên quan">
      
        <meta name="lang:search.result.other" content="# tài liệu liên quan">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/logo.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Dart Async - Bùi Hải Nam</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#00bcd4">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="manifest" href="../../manifest.webmanifest">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-139140751-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="cyan" data-md-color-accent="cyan">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#1-future" tabindex="1" class="md-skip">
        Vào thẳng nội dung
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://buihainam.com/" title="Bùi Hải Nam" class="md-header-nav__button md-logo">
          
            <img src="../../img/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Bùi Hải Nam
            </span>
            <span class="md-header-nav__topic">
              
                Dart Async
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Tìm kiếm" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Nhập để bắt đầu tìm kiếm
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/VNAPNIC/Learn-to-Code" title="Đến kho lưu trữ mã nguồn" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    VNAPNIC/Learn-to-Code
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://buihainam.com/" title="Bùi Hải Nam" class="md-nav__button md-logo">
      
        <img src="../../img/logo.png" width="48" height="48">
      
    </a>
    Bùi Hải Nam
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/VNAPNIC/Learn-to-Code" title="Đến kho lưu trữ mã nguồn" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    VNAPNIC/Learn-to-Code
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Programming
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Programming
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../programming/lap-trinh-tuyen-tinh-la-gi-uu-nhuoc-diem/" title="Lập trình tuyến tính là gì" class="md-nav__link">
      Lập trình tuyến tính là gì
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../programming/lap-trinh-cau-truc-la-gi-uu-nhuoc-diem/" title="Lập trình cấu trúc là gì" class="md-nav__link">
      Lập trình cấu trúc là gì
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../programming/lap-trinh-huong-doi-tuong-la-gi-uu-nhuoc-diem/" title="Lập trình hướng đối tượng là gì" class="md-nav__link">
      Lập trình hướng đối tượng là gì
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../programming/oop-vs-pop/" title="So sánh POP với OOP" class="md-nav__link">
      So sánh POP với OOP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../java/ngon-ngu-java-la-gi/" title="Ngôn ngữ Java là gì" class="md-nav__link">
      Ngôn ngữ Java là gì
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../java/cac-tinh-chat-huong-doi-tuong-cua-java/" title="OOP Trong Java" class="md-nav__link">
      OOP Trong Java
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      JUnit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        JUnit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../junit/junit-la-gi-vi-du-junit-voi-eclipse-maven/" title="JUnit là gì" class="md-nav__link">
      JUnit là gì
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../junit/assertions-la-gi-code-vi-du-junit-voi-assertions/" title="Assertions là gì" class="md-nav__link">
      Assertions là gì
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../junit/test-runner-va-test-suite-tao-bo-test-voi-junit/" title="Test runner và Test suite" class="md-nav__link">
      Test runner và Test suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../junit/thu-tu-chay-cac-test-case-trong-junit-vi-du/" title="Thứ tự chạy các test case trong JUnit" class="md-nav__link">
      Thứ tự chạy các test case trong JUnit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../junit/junit-expected-exceptions-code-vi-du-test-exception-voi-junit/" title="JUnit Expected Exceptions" class="md-nav__link">
      JUnit Expected Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../junit/vi-du-junit-voi-matchers-va-assertthat/" title="JUnit với Matchers và assertThat" class="md-nav__link">
      JUnit với Matchers và assertThat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../junit/vi-du-junit-ignoring-tests-va-timeout-voi-test-case/" title="JUnit Ignoring và Timeout với test case" class="md-nav__link">
      JUnit Ignoring và Timeout với test case
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Kotlin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Kotlin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_basic/" title="Kotlin Basic" class="md-nav__link">
      Kotlin Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_class_inheritance/" title="Kotlin Class và kế thừa" class="md-nav__link">
      Kotlin Class và kế thừa
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_property_field/" title="Kotlin Property và field" class="md-nav__link">
      Kotlin Property và field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_function/" title="Kotlin Funtion" class="md-nav__link">
      Kotlin Funtion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_inline_function/" title="Kotlin Inline function" class="md-nav__link">
      Kotlin Inline function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_higher_order_function/" title="Kotlin Higher order funtion" class="md-nav__link">
      Kotlin Higher order funtion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_inteface/" title="Kotlin Inteface" class="md-nav__link">
      Kotlin Inteface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_data_class/" title="Kotlin Data class" class="md-nav__link">
      Kotlin Data class
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_nested_class/" title="Kotlin Nested class" class="md-nav__link">
      Kotlin Nested class
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_visibility_modifiers/" title="Kotlin Visibility Modifiers" class="md-nav__link">
      Kotlin Visibility Modifiers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_lambda/" title="Kotlin Lambda" class="md-nav__link">
      Kotlin Lambda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_collection/" title="Kotlin Collection" class="md-nav__link">
      Kotlin Collection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_enum_classes/" title="Kotlin Enum Classes" class="md-nav__link">
      Kotlin Enum Classes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_overloading_operator/" title="Kotlin Overloading operator" class="md-nav__link">
      Kotlin Overloading operator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_range/" title="Kotlin Range" class="md-nav__link">
      Kotlin Range
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_idioms/" title="Kotlin Idioms" class="md-nav__link">
      Kotlin Idioms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_exception/" title="Kotlin Exception" class="md-nav__link">
      Kotlin Exception
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_delegation/" title="Kotlin Delegation" class="md-nav__link">
      Kotlin Delegation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/kotlin_delegated_property/" title="Kotlin Delegated property" class="md-nav__link">
      Kotlin Delegated property
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/call_java_from_kotlin/" title="Gọi Java code từ Kotlin" class="md-nav__link">
      Gọi Java code từ Kotlin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kotlin/call_kotlin_from_java/" title="Gọi Kotlin từ Java" class="md-nav__link">
      Gọi Kotlin từ Java
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Dart
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Dart
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dart_environment_settings/" title="Dart Cài đặt môi trường" class="md-nav__link">
      Dart Cài đặt môi trường
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dart_core/" title="Dart Basic" class="md-nav__link">
      Dart Basic
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Dart Async
      </label>
    
    <a href="./" title="Dart Async" class="md-nav__link md-nav__link--active">
      Dart Async
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Mục lục</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-future" class="md-nav__link">
    1. Future
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-generator-function" class="md-nav__link">
    2. Generator function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-stream" class="md-nav__link">
    3. Stream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#streamcontroller" class="md-nav__link">
    StreamController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streamsubscription" class="md-nav__link">
    StreamSubscription
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streamtransformer" class="md-nav__link">
    StreamTransformer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-subscription-stream" class="md-nav__link">
    Single-subscription Stream:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadcast-streams" class="md-nav__link">
    Broadcast Streams
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tong-ket" class="md-nav__link">
    Tổng kết
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Flutter
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Flutter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../flutter/flutter_introduction/" title="9 lý do tại sao nên chọn Flutter" class="md-nav__link">
      9 lý do tại sao nên chọn Flutter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../flutter/flutter_screenutil/" title="Flutter ScreenUtil" class="md-nav__link">
      Flutter ScreenUtil
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Mục lục</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-future" class="md-nav__link">
    1. Future
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-generator-function" class="md-nav__link">
    2. Generator function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-stream" class="md-nav__link">
    3. Stream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#streamcontroller" class="md-nav__link">
    StreamController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streamsubscription" class="md-nav__link">
    StreamSubscription
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streamtransformer" class="md-nav__link">
    StreamTransformer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-subscription-stream" class="md-nav__link">
    Single-subscription Stream:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadcast-streams" class="md-nav__link">
    Broadcast Streams
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tong-ket" class="md-nav__link">
    Tổng kết
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Dart Async</h1>
                
                <p>Cũng như các ngôn ngữ khác, Dart không thể thiếu việc lập trình bất đồng bộ. Code chạy trong Dart là chạy trên một luồng (thread), dòng code bạn viết nó thi hành hết câu lệnh này sang câu lệnh khác. Nên một khối lệnh nào đó khóa thread (làm tắc thread) thì toàn bộ ứng dụng bị treo. Các Asynchronous operations giúp chương trình của bạn hoàn thành công việc khác trong khi chờ đợi một operation kết thúc. Dart sử dụng <a href="https://api.dartlang.org/stable/2.2.0/dart-async/Future-class.html">Future</a> và <a href="https://api.dartlang.org/stable/2.2.0/dart-async/Stream-class.html">Stream</a> để thực hiện các hoạt động không đồng bộ.</p>
<h2 id="1-future">1. Future<a class="headerlink" href="#1-future" title="Permanent link">&para;</a></h2>
<ul>
<li>Future là một đối tượng Future đại diện cho một tính toán mà giá trị trả về có thể chưa có sẵn.</li>
<li>Future trả về giá trị của tính toán khi nó hoàn thành vào một thời điểm nào đó trong tương lai.</li>
<li>Future thường được sử dụng cho các tính toán có khả năng dài như I/O và tương tác với người dùng.</li>
</ul>
<p>Để làm việc với <a href="https://api.dartlang.org/stable/2.2.0/dart-async/Future-class.html">Future</a>, bạn có thể sử dụng <code>async</code> và <code>await</code> hoặc Future API.</p>
<p>Function bất đồng bộ được khai báo có từ khóa <code>async</code> phía sau, và đối tượng trả về của function là <a href="https://api.dartlang.org/stable/2.2.0/dart-async/Future-class.html">Future\<T></a>, với T là kiểu biểu thức return trả về.</p>
<p>Nếu một function đã khai báo là bất đồng bộ <code>async</code> thì trong function có thể sử dụng thêm từ khóa <code>await</code> - chờ cho biểu thức thi hành xong mới thi hành các code tiếp theo của function.</p>
<div class="codehilite"><pre><span></span><span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Future</span> <span class="n">f</span> <span class="o">=</span> <span class="n">showInfomation</span><span class="p">();</span>
    <span class="n">f</span><span class="p">.</span><span class="n">then</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">notifyFinish</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    <span class="p">.</span><span class="n">catchError</span><span class="p">((</span><span class="n">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">print</span><span class="p">(</span><span class="s1">&#39;Lỗi xảy ra - &#39;</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">toString</span><span class="p">()));</span>
  <span class="n">secondFunction</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">notifyFinish</span><span class="p">(</span><span class="kt">String</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">print</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span> <span class="n">showInfomation</span><span class="p">()</span> <span class="kd">async</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="n">data</span> <span class="o">=</span> <span class="kd">await</span> <span class="n">getInfomation</span><span class="p">();</span>
  <span class="n">print</span><span class="p">(</span><span class="s1">&#39;This is your data -&#39;</span> <span class="o">+</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">toString</span><span class="p">());</span>
  <span class="n">print</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
  <span class="k">return</span> <span class="s1">&#39;showInfomation Complete!&#39;</span><span class="p">;</span> <span class="c1">//Trả về chuỗi - chứa trong Future</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="n">info</span> <span class="o">=</span> <span class="s1">&#39;#4fs358wredsfadsfdfdw&#39;</span><span class="p">;</span>

<span class="n">getInfomation</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">info</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">secondFunction</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">print</span><span class="p">(</span><span class="s1">&#39;Thời gian - &#39;</span> <span class="o">+</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">toString</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>

<div class="codehilite"><pre><span></span>    <span class="n">Future</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span> <span class="n">showInfomation</span><span class="p">()</span> <span class="kd">async</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="n">data</span> <span class="o">=</span> <span class="kd">await</span> <span class="n">getInfomation</span><span class="p">();</span>
        <span class="n">print</span><span class="p">(</span><span class="s1">&#39;This is your data -&#39;</span> <span class="o">+</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">toString</span><span class="p">());</span>
        <span class="n">print</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="k">return</span> <span class="s1">&#39;showInfomation Complete!&#39;</span><span class="p">;</span> <span class="c1">//Trả về chuỗi - chứa trong Future</span>
    <span class="p">}</span>
</pre></div>

<p>Trả về từ hàm <code>async</code> là một đối tượng Future. Từ đối tượng này, ta có thể gán các hàm callback, được chạy mỗi khi dữ liệu hoàn thành trả về bởi hàm <code>async</code>, để gán hàm callback sử dụng phương thức: <code>Future.then((data) =&gt; callBack(data));</code></p>
<div class="codehilite"><pre><span></span>    <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Future</span> <span class="n">f</span> <span class="o">=</span> <span class="n">showInfomation</span><span class="p">();</span>
        <span class="n">f</span><span class="p">.</span><span class="n">then</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">notifyFinish</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
         <span class="p">.</span><span class="n">catchError</span><span class="p">((</span><span class="n">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">print</span><span class="p">(</span><span class="s1">&#39;Lỗi xảy ra - &#39;</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">toString</span><span class="p">()));</span>
        <span class="n">secondFunction</span><span class="p">();</span>
    <span class="p">}</span>
</pre></div>

<p>Nếu muốn bắt lỗi trong hàm <code>async</code> cũng dùng biểu thức <code>try ... catch</code> Hoặc từ đối tượng Future trả về thì sử dụng phương thức <code>catchError()</code></p>
<p>Dùng biểu thức <code>try ... catch</code></p>
<div class="codehilite"><pre><span></span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span> <span class="n">showInfomation</span><span class="p">()</span> <span class="kd">async</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="n">data</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">data</span> <span class="o">=</span> <span class="kd">await</span> <span class="n">getInfomation</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//Xử lý lỗi</span>
  <span class="p">};</span>
  <span class="n">print</span><span class="p">(</span><span class="s1">&#39;This is your data -&#39;</span> <span class="o">+</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">toString</span><span class="p">());</span>
  <span class="n">print</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
  <span class="k">return</span> <span class="s1">&#39;showInfomation Complete!&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>Nếu không bắt lỗi trực tiếp từ <code>async</code>, có thể bắt lỗi ở <code>Future</code>, đây là ví dụ:</p>
<div class="codehilite"><pre><span></span>    <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
      <span class="n">Future</span> <span class="n">f</span> <span class="o">=</span> <span class="n">showInfomation</span><span class="p">();</span>
      <span class="n">f</span><span class="p">.</span><span class="n">then</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="o">=&gt;</span><span class="n">notifyFinish</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
       <span class="p">.</span><span class="n">catchError</span><span class="p">((</span><span class="n">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">print</span><span class="p">(</span><span class="s1">&#39;Lỗi xảy ra - &#39;</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">toString</span><span class="p">()));</span>
      <span class="n">secondFunction</span><span class="p">();</span>
    <span class="p">}</span>
</pre></div>

<p>Bạn hãy throw một Exception trong hàm getInfomation, hoặc showInfomation để xem lỗi bắt được.</p>
<p>Ví dụ phát sinh lỗi ở hàm <code>getInfomation</code></p>
<div class="codehilite"><pre><span></span><span class="n">getInfomation</span><span class="p">()</span>  <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="m">1000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">);</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="n">Exception</span><span class="p">(</span><span class="s1">&#39;Không lấy được thông tin&#39;</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">info</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<h2 id="2-generator-function">2. Generator function<a class="headerlink" href="#2-generator-function" title="Permanent link">&para;</a></h2>
<p>Có thể hiểu Generator function là một function, có khả năng tạm ngưng thực thi trước khi hàm kết thúc, và có thể tiếp tục chạy ở 1 thời điểm khác.</p>
<p>Synchronous generator: Trả về 1 Iterable object. <code>sync*</code>
Asynchronous generator: Trả về 1 Stream object. <code>async*</code></p>
<p>Một số từ khóa thường sử dụng trong generator function:</p>
<ul>
<li><code>sync*</code>, <code>async*</code>: đánh dấu là generator function.</li>
<li><code>yield</code>: phát ra các giá trị.</li>
<li><code>yield*</code>: phát ra các giá trị nếu generator là đệ quy.</li>
<li><code>await for</code>: được thiết kế để hoạt động tốt với stream.</li>
</ul>
<div class="codehilite"><pre><span></span>    <span class="n">Iterable</span> <span class="n">naturalsTo</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="kd">sync</span><span class="o">*</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="kd">yield</span> <span class="n">k</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>

<div class="codehilite"><pre><span></span>    <span class="n">Stream</span> <span class="n">asynchronousNaturalsTo</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="kd">async</span><span class="o">*</span> <span class="p">{</span>
      <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>
      <span class="k">while</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="kd">yield</span> <span class="n">k</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>

<div class="codehilite"><pre><span></span>    <span class="n">Iterable</span> <span class="n">naturalsDownFrom</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="kd">sync</span><span class="o">*</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">yield</span> <span class="n">n</span><span class="p">;</span>
        <span class="kd">yield</span><span class="o">*</span> <span class="n">naturalsDownFrom</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="m">1</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
</pre></div>

<h2 id="3-stream">3. Stream<a class="headerlink" href="#3-stream" title="Permanent link">&para;</a></h2>
<p>Cung cấp một chuỗi dữ liệu không đồng bộ(tương tự với observables trong Rx, LiveData trong Android JetPack).</p>
<h3 id="streamcontroller">StreamController<a class="headerlink" href="#streamcontroller" title="Permanent link">&para;</a></h3>
<p>Có chứa 1 simple stream. sử dụng để tạo stream, kiểm soát stream(listen on, push event).</p>
<div class="codehilite"><pre><span></span>    <span class="n">StreamController</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span> <span class="n">streamController</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StreamController</span><span class="p">();</span>
    <span class="n">streamController</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="n">listen</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">print</span><span class="p">(</span><span class="s2">&quot;DataReceived: &quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">);</span>
      <span class="p">},</span> <span class="nl">onDone:</span> <span class="p">()</span> <span class="p">{</span>
        <span class="n">print</span><span class="p">(</span><span class="s2">&quot;Task Done&quot;</span><span class="p">);</span>
      <span class="p">},</span> <span class="nl">onError:</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">print</span><span class="p">(</span><span class="s2">&quot;Some Error&quot;</span><span class="p">);</span>
      <span class="p">});</span>

    <span class="n">streamController</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;This a test data&quot;</span><span class="p">);</span>
</pre></div>

<h3 id="streamsubscription">StreamSubscription<a class="headerlink" href="#streamsubscription" title="Permanent link">&para;</a></h3>
<p>Cung cấp các sự kiện cho listener và giữ các callbacks được sử dụng để xử lý các sự kiện.<br>
Khi bạn định nghĩa 1 listener, bạn sẽ nhận được <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamSubscription-class.html">StreamSubscription</a> object. <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamSubscription-class.html">StreamSubscription</a> sẽ thông báo cho bạn biết có điều gì đặc biệt xảy ra trong Stream(Giá trị được đẩy ra khỏi Stream, có lỗi xảy ra, Stream bị huỷ...). Do đó, <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamSubscription-class.html">StreamSubscription</a> có thể được sử dụng để tạm dừng/tiếp tục event từ các stream khi được yêu cầu.<br>
Chú ý: Phải đảm bảo hủy <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamSubscription-class.html">StreamSubscription</a> khi không cần thiết.</p>
<div class="codehilite"><pre><span></span>    <span class="kd">final</span> <span class="n">StreamSubscription</span> <span class="n">subscription</span> <span class="o">=</span> <span class="n">ctrl</span><span class="p">.</span><span class="n">stream</span>
                          <span class="p">.</span><span class="n">where</span><span class="p">((</span><span class="n">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">value</span> <span class="o">%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">0</span><span class="p">))</span>
                          <span class="p">.</span><span class="n">listen</span><span class="p">((</span><span class="n">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">value</span><span class="s1">&#39;</span><span class="p">));</span>

    <span class="n">subscription</span><span class="p">.</span><span class="n">onData</span><span class="p">((</span><span class="n">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">print</span><span class="p">(</span><span class="s2">&quot;sub_</span><span class="si">$</span><span class="n">value</span><span class="s2">&quot;</span><span class="p">));</span>
</pre></div>

<h3 id="streamtransformer">StreamTransformer<a class="headerlink" href="#streamtransformer" title="Permanent link">&para;</a></h3>
<p>Được sử dụng để xử lý dữ liệu trước khi dữ liệu được đẩy ra ngoài. Đầu ra của <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamTransformer-class.html">StreamTransformer</a> là 1 Stream.<br>
Một StreamTransformer có thể sử dụng trong 1 số quá trình như:</p>
<ul>
<li>Filtering: lọc dữ liệu theo 1 định nghĩa nào đó.</li>
<li>Regrouping: Tập hợp các dữ liệu.</li>
<li>Modification: Chỉnh sửa dữ liệu.</li>
<li>Chèn dữ liệu vào 1 luồng khác.</li>
<li>Buffering.</li>
<li>Processing: Thực hiện 1 hành động/ hoạt động nào đó dựa vào dữ liệu.</li>
<li>v.v...</li>
</ul>
<p>Để tạo ra 1 <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamTransformer-class.html">StreamTransformer</a>, sử dụng factory constructor <code>fromHandlers()</code>.
Và để bắt đầu sử dụng <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamTransformer-class.html">StreamTransformer</a> cho <a href="https://api.dartlang.org/stable/2.2.0/dart-async/Stream-class.html">Stream</a> thì gọi method <code>transform()</code> và truyền vào 1 <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamTransformer-class.html">StreamTransformer</a></p>
<div class="codehilite"><pre><span></span>    <span class="n">StreamTransformer</span><span class="o">&lt;</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;</span><span class="p">.</span><span class="n">fromHandlers</span><span class="p">({</span>
        <span class="kt">void</span> <span class="n">handleData</span><span class="p">(</span><span class="n">S</span> <span class="n">data</span><span class="p">,</span> <span class="n">EventSink</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">sink</span> <span class="p">),</span>
        <span class="kt">void</span> <span class="n">handleError</span><span class="p">(</span><span class="kt">Object</span> <span class="n">error</span><span class="p">,</span> <span class="n">StackTrace</span> <span class="n">stackTrace</span><span class="p">,</span> <span class="n">EventSink</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">sink</span><span class="p">),</span>
        <span class="kt">void</span> <span class="n">handleDone</span><span class="p">(</span><span class="n">EventSink</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">sink</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="n">stringStream</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="k">new</span> <span class="n">StreamTransformer</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="o">&gt;</span><span class="p">.</span><span class="n">fromHandlers</span><span class="p">(</span>
        <span class="nl">handleData:</span> <span class="p">(</span><span class="kt">String</span> <span class="n">value</span><span class="p">,</span> <span class="n">EventSink</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span> <span class="n">sink</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">sink</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
          <span class="n">sink</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>  <span class="c1">// Duplicate the incoming events.</span>
        <span class="p">}));</span>
</pre></div>

<p>Có 2 loại <a href="https://api.dartlang.org/stable/2.2.0/dart-async/Stream-class.html">Stream</a>: <a href="https://www.dartlang.org/tutorials/language/streams#single-subscription-streams">Single-subscription Stream</a>, <a href="https://www.dartlang.org/tutorials/language/streams#broadcast-streams">Broadcast Streams</a>.</p>
<h3 id="single-subscription-stream">Single-subscription Stream:<a class="headerlink" href="#single-subscription-stream" title="Permanent link">&para;</a></h3>
<p>Là loại Stream chỉ cho phép tạo duy nhất 1 listener.
Khi thêm 1 listener trỏ vào Stream này, thì nó sẽ huỷ đi listener đầu tiên.</p>
<p>Cách để tạo ra 1 <a href="https://www.dartlang.org/tutorials/language/streams#single-subscription-streams">Single-subscription Stream</a> là sử dụng <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamController-class.html">StreamController</a> với constructor mặc định.</p>
<p>Ví dụ về Single-subcription Stream:</p>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//</span>
  <span class="c1">// Initialize a &quot;Single-Subscription&quot; Stream controller</span>
  <span class="c1">//</span>
  <span class="kd">final</span> <span class="n">StreamController</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="n">StreamController</span><span class="p">();</span>

  <span class="c1">//</span>
  <span class="c1">// Initialize a single listener which simply prints the data</span>
  <span class="c1">// as soon as it receives it</span>
  <span class="c1">//</span>
  <span class="kd">final</span> <span class="n">StreamSubscription</span> <span class="n">subscription</span> <span class="o">=</span> <span class="n">ctrl</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="n">listen</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">data</span><span class="s1">&#39;</span><span class="p">));</span>
<span class="c1">//   final StreamSubscription subscription1 = ctrl.stream.listen((data) =&gt; print(&#39;$data&#39;)); // wrong and throw exception &#39;Bad state: Stream has already been listened to.&#39;</span>

  <span class="c1">//</span>
  <span class="c1">// We here add the data that will flow inside the stream</span>
  <span class="c1">//</span>
  <span class="n">ctrl</span><span class="p">.</span><span class="n">sink</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;my name&#39;</span><span class="p">);</span>
  <span class="n">ctrl</span><span class="p">.</span><span class="n">sink</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="m">1234</span><span class="p">);</span>
  <span class="n">ctrl</span><span class="p">.</span><span class="n">sink</span><span class="p">.</span><span class="n">add</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="o">:</span> <span class="s1">&#39;element A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="o">:</span> <span class="s1">&#39;element B&#39;</span><span class="p">});</span>
  <span class="n">ctrl</span><span class="p">.</span><span class="n">sink</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="m">123.45</span><span class="p">);</span>

  <span class="c1">//</span>
  <span class="c1">// We release the StreamController</span>
  <span class="c1">//</span>
  <span class="n">ctrl</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<h3 id="broadcast-streams">Broadcast Streams<a class="headerlink" href="#broadcast-streams" title="Permanent link">&para;</a></h3>
<p>Ngược lại với loại trên, nó cho phép tạo rất nhiều listener.
Có thể thêm listener vào <a href="https://www.dartlang.org/tutorials/language/streams#broadcast-streams">Broadcast Streams</a> bất cứ lúc nào.
Listener mới sẽ nhận được các event kể từ thời điểm nó bắt đầu đăng ký Stream.</p>
<p>Để tạo 1 <a href="https://www.dartlang.org/tutorials/language/streams#broadcast-streams">Broadcast Streams</a>, ta sử dụng factory constructor của <a href="https://api.dartlang.org/stable/2.2.0/dart-async/StreamController-class.html">StreamController</a> là <code>StreamController.broadcast()</code>.</p>
<div class="codehilite"><pre><span></span><span class="n">StreamController</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span> <span class="n">streamController</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StreamController</span><span class="p">.</span><span class="n">broadcast</span><span class="p">();</span> 

<span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">print</span><span class="p">(</span><span class="s2">&quot;Creating a StreamController...&quot;</span><span class="p">);</span>
  <span class="c1">//First subscription</span>
  <span class="n">streamController</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="n">listen</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">print</span><span class="p">(</span><span class="s2">&quot;DataReceived1: &quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">);</span>
  <span class="p">},</span> <span class="nl">onDone:</span> <span class="p">()</span> <span class="p">{</span>
    <span class="n">print</span><span class="p">(</span><span class="s2">&quot;Task Done1&quot;</span><span class="p">);</span>
  <span class="p">},</span> <span class="nl">onError:</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">print</span><span class="p">(</span><span class="s2">&quot;Some Error1&quot;</span><span class="p">);</span>
  <span class="p">});</span>
  <span class="c1">//Second subscription</span>
  <span class="n">streamController</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="n">listen</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">print</span><span class="p">(</span><span class="s2">&quot;DataReceived2: &quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">);</span>
  <span class="p">},</span> <span class="nl">onDone:</span> <span class="p">()</span> <span class="p">{</span>
    <span class="n">print</span><span class="p">(</span><span class="s2">&quot;Task Done2&quot;</span><span class="p">);</span>
  <span class="p">},</span> <span class="nl">onError:</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">print</span><span class="p">(</span><span class="s2">&quot;Some Error2&quot;</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="n">streamController</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;This a test data&quot;</span><span class="p">);</span>
  <span class="n">streamController</span><span class="p">.</span><span class="n">sink</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;SINK&#39;</span><span class="p">);</span>
  <span class="n">print</span><span class="p">(</span><span class="s2">&quot;code controller is here&quot;</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>

<h2 id="tong-ket">Tổng kết<a class="headerlink" href="#tong-ket" title="Permanent link">&para;</a></h2>
<p>Bài viết đã trình bày tổng quan về xử lý đồng bộ và bất đồng bộ trong dart. Để có cái nhìn tổng quan hơn, tôi xin đưa ra một ví dụ sử dụng kết hợp những điều đã trình bày bên trên</p>
<div class="codehilite"><pre><span></span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">sumStream</span><span class="p">(</span><span class="n">Stream</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">stream</span><span class="p">)</span> <span class="kd">async</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="n">sum</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>
  <span class="kd">await</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="n">value</span> <span class="k">in</span> <span class="n">stream</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">sum</span> <span class="o">+=</span> <span class="n">value</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">sum</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Stream</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">countStream</span><span class="p">(</span><span class="kt">int</span> <span class="n">to</span><span class="p">)</span> <span class="kd">async</span><span class="o">*</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">to</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="m">5</span><span class="p">)</span> <span class="k">throw</span> <span class="n">Exception</span><span class="p">;</span>
    <span class="kd">yield</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// yield will throw value to stream listen and handle.</span>
    <span class="kd">await</span> <span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span> <span class="m">1</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">secondFunction</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">print</span><span class="p">(</span><span class="s1">&#39;secondFunction&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">main</span><span class="p">()</span> <span class="kd">async</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">countStream</span><span class="p">(</span><span class="m">10</span><span class="p">);</span>
  <span class="n">stream</span><span class="p">.</span><span class="n">listen</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="n">print</span><span class="p">(</span><span class="n">data</span><span class="p">)},</span>
      <span class="nl">onDone:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;stream onDone&#39;</span><span class="p">)},</span>
      <span class="nl">onError:</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">print</span><span class="p">(</span><span class="s1">&#39;error: </span><span class="si">$</span><span class="n">err</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="p">});</span><span class="c1">// this is a single stream subcription, so it can listen only once.</span>
  <span class="n">secondFunction</span><span class="p">();</span>

  <span class="n">Future</span> <span class="n">z</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Future</span><span class="p">.</span><span class="kd">sync</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="n">print</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">));</span>

  <span class="c1">// this function listen stream once above, so can not execute these comment code below</span>
<span class="c1">//   var sum = await sumStream(stream).catchError((err) =&gt; {print(&#39;error: $err&#39;)});</span>
<span class="c1">//   print(sum); // 55</span>
<span class="p">}</span>
</pre></div>

<p>Bài viết xin được dừng tại đây. Mong bạn có thể hiểu và sử dụng được các Asynchronous operations đồng bộ trong Dart. Trong quá trình tìm hiểu không tránh khỏi sai sót, hy vọng được sự góp ý của mọi người. </p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../dart_core/" title="Dart Basic" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Trước
                </span>
                Dart Basic
              </span>
            </div>
          </a>
        
        
          <a href="../../flutter/flutter_introduction/" title="9 lý do tại sao nên chọn Flutter" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Sau
                </span>
                9 lý do tại sao nên chọn Flutter
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 - 2020 Bùi Hải Nam
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="http://finishcoding.com/" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/VNAPNIC" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://www.facebook.com/NankaiNotes" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/channel/UCECQ8GHamKx4H5jHMmNi2Ag" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>